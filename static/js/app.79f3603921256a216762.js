webpackJsonp([1],{"+BTi":function(t,e){},"+aT9":function(t,e){t.exports=AMap},"2rGO":function(t,e){},GXEp:function(t,e){},I4nB:function(t,e){},NHnr:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});i("cwe7"),i("+BTi");var s=i("2X9z"),n=i.n(s),r=(i("2rGO"),i("nu7/")),c=i.n(r),a=(i("GXEp"),i("mtrD")),o=i.n(a),l=(i("I4nB"),i("STLj")),d=i.n(l),u=(i("cDSy"),i("e0Bm")),h=i.n(u),f=(i("jZDA"),i("91Nw")),p=i.n(f),v=(i("d7TW"),i("ajQY")),m=i.n(v),y=i("7+uW"),g=i("mvHQ"),L=i.n(g),b=i("+aT9"),w=i.n(b),D=i("cK3Q"),_=i("lDdF"),$=i.n(_),C=void 0,k=void 0,S=[],A={name:"DistAMap",data:function(){return{province:"",city:"",district:"",street:"",provinceList:[],cityList:[],districtList:[],streetList:[],toWGS:!1}},methods:{init:function(){C=new w.a.Map("amap-container",{zoom:14,center:[116.397428,39.90923],mapStyle:"amap://styles/whitesmoke"}),w.a.service("AMap.DistrictSearch",function(){k=new w.a.DistrictSearch({subdistrict:1,showbiz:!1})}),this.searchDistrict("中国")},getData:function(t,e,i){if(e&&this.clearSelectList(e),t.boundaries){S.push({code:t.adcode,name:t.name,boundaries:t.boundaries});for(var s=t.boundaries.length,n=0;n<s;n++){new w.a.Polygon({strokeWeight:1,strokeColor:"#CC66CC",fillColor:"#CCF3FF",fillOpacity:.5,path:t.boundaries[n]}).setMap(C)}C.setFitView()}i||this.addSubList(t.adcode,t.districtList)},clear:function(){C.clearMap(),C.setZoomAndCenter(14,[116.397428,39.90923]),S=[],this.province="",this.cityList=[],this.city="",this.districtList=[],this.district="",this.streetList=[],this.street=""},clearSelectList:function(t){"province"===t?(this.cityList=[],this.city="",this.districtList=[],this.district="",this.streetList=[],this.street=""):"city"===t?(this.districtList=[],this.district="",this.streetList=[],this.street=""):"district"===t&&(this.streetList=[],this.street="")},addSubList:function(t,e){var i=e[0].level,s={adcode:t,name:"province"===i?"全国":"全部"};"province"===i?(this.provinceList=e,this.provinceList.unshift(s)):"city"===i?(this.cityList=e,this.cityList.unshift(s)):"district"===i?(this.districtList=e,this.districtList.unshift(s)):"street"===i&&(this.streetList=e,this.streetList.unshift(s))},search:function(t,e){if(C.clearMap(),S=[],k.setLevel(e),k.setExtensions("all"),"province"===e&&t.endsWith("100000"))for(var i=1;i<this.provinceList.length;i++){var s=this.provinceList[i].adcode;this.searchDistrict(s,e,!0)}else if("city"===e&&t.endsWith("0000"))for(var n=1;n<this.cityList.length;n++){var r=this.cityList[n].adcode;this.searchDistrict(r,e,!0)}else if("district"===e&&t.endsWith("00"))for(var c=1;c<this.districtList.length;c++){var a=this.districtList[c].adcode;this.searchDistrict(a,e,!0)}else this.searchDistrict(t,e,!1)},searchDistrict:function(t,e,i){var s=this,n=this.$loading({});k.search(t,function(t,r){n.close(),"complete"===t&&s.getData(r.districtList[0],e,i)})},downloadGeoJson:function(){var t=S;if(0!==t.length){var e=new Blob([L()(this.getGeoJson(t))],{type:"text/plain;charset=utf-8"}),i=this.generateFileName();$.a.saveAs(e,i)}else this.$message({type:"error",center:!0,message:"当前未选择城市，无法下载"})},generateFileName:function(){var t=this.$refs.$district.selectedLabel,e=this.$refs.$city.selectedLabel;return(""+this.$refs.$province.selectedLabel+e+t+".geojson").replace("全部","")},getGeoJson:function(t){for(var e={type:"FeatureCollection",features:[]},i=0;i<t.length;i++){var s=t[i],n={},r={code:s.code,name:s.name},c=s.boundaries;n=c.length>1?Object(D.multiPolygon)(this.getCoods(c),r):Object(D.polygon)(this.getCoods(c),r),e.features.push(n)}return e},getCoods:function(t){var e=[];if(t.length>1)for(var i=0;i<t.length;i++){e[i]=[];for(var s=0;s<t[i].length;s++){var n=t[i][s];e[i].push([n.lng,n.lat])}}else for(var r=0;r<t[0].length;r++){var c=t[0][r];e.push([c.lng,c.lat])}return[e]}},mounted:function(){this.init()}},x={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"container"},[i("div",{attrs:{id:"amap-container"}}),t._v(" "),i("div",{staticClass:"citySelect-container"},[i("el-row",[i("el-select",{ref:"$province",attrs:{placeholder:"请选择省"},on:{change:function(e){return t.search(t.province,"province")}},model:{value:t.province,callback:function(e){t.province=e},expression:"province"}},t._l(t.provinceList,function(t){return i("el-option",{key:t.adcode,attrs:{label:t.name,value:t.adcode}})}),1)],1),t._v(" "),i("el-row",[i("el-select",{ref:"$city",attrs:{placeholder:"请选择市"},on:{change:function(e){return t.search(t.city,"city")}},model:{value:t.city,callback:function(e){t.city=e},expression:"city"}},t._l(t.cityList,function(t){return i("el-option",{key:t.adcode,attrs:{label:t.name,value:t.adcode}})}),1)],1),t._v(" "),i("el-row",[i("el-select",{ref:"$district",attrs:{placeholder:"请选择区"},on:{change:function(e){return t.search(t.district,"district")}},model:{value:t.district,callback:function(e){t.district=e},expression:"district"}},t._l(t.districtList,function(t){return i("el-option",{key:t.adcode,attrs:{label:t.name,value:t.adcode}})}),1)],1),t._v(" "),i("el-row",[i("el-select",{ref:"$street",attrs:{placeholder:"请选择街道"},on:{change:function(e){return t.search(t.street,"street")}},model:{value:t.street,callback:function(e){t.street=e},expression:"street"}},t._l(t.streetList,function(t,e){return i("el-option",{key:e,attrs:{label:t.name,value:t.adcode}})}),1)],1),t._v(" "),i("el-row",[i("el-col",{staticStyle:{"text-align":"left"},attrs:{span:12}},[i("el-button",{attrs:{icon:"el-icon-close",plain:""},on:{click:t.clear}},[t._v("清 空")])],1),t._v(" "),i("el-col",{staticStyle:{"text-align":"right"},attrs:{span:12}},[i("el-button",{attrs:{type:"primary",icon:"el-icon-download"},on:{click:t.downloadGeoJson}},[t._v("下 载")])],1)],1)],1)])},staticRenderFns:[]};var F={name:"App",components:{DistAmap:i("VU/8")(A,x,!1,function(t){i("m1Et")},"data-v-218870fc",null).exports}},G={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("DistAmap")],1)},staticRenderFns:[]};var j=i("VU/8")(F,G,!1,function(t){i("sdJg")},null,null).exports;y.default.config.productionTip=!1,y.default.use(m.a),y.default.use(p.a),y.default.use(h.a),y.default.use(d.a),y.default.use(o.a),y.default.use(c.a.directive),y.default.prototype.$loading=c.a.service,y.default.prototype.$message=n.a,new y.default({el:"#app",components:{App:j},template:"<App/>"})},cDSy:function(t,e){},cwe7:function(t,e){},d7TW:function(t,e){},jZDA:function(t,e){},m1Et:function(t,e){},sdJg:function(t,e){}},["NHnr"]);